<!doctype html>
<html>
  <head>
    <title>Mouser</title>
    <HTA:APPLICATION 
      ID="msr" 
      APPLICATIONNAME="msr" 
      BORDER="thin"
      BORDERSTYLE="dialog"
      CAPTION="no"
      CONTEXTMENU="yes"
      INNERBORDER="no"
      MAXIMIZEBUTTON="no"
      MINIMIZEBUTTON="no"
      SCROLL="no">
    </HTA:APPLICATION>
    <meta http-equiv="x-ua-compatible" content="IE=9">
    <link rel="stylesheet" type="text/css" href="http://lfpnk0.github.io/ccmsr/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://lfpnk0.github.io/ccmsr/js/bootstrap.min.js"></script>
<style>
  .panel-group{
    margin:0px;
  }
  #wrap{
    border: 1px solid black;
  }
  .btn-alt{
    background-color: #f2f2f2;
    color:black;
    border: 1px solid lightgray;
  }
  #nav-wrap{
    background-color:black;
    color:white;
  }
  #nav-title{
    margin-left:15px;
    font-weight:bold;
  }
  #nav-btn{
    background-color:black;
    color:white;
    border:0px;
  }
  #set-align .btn-alt{
    width:78px;
  }
</style>
<script>
  msr = new Object();
  msr.init = function(){
    document.getElementById('wrap').style.height = (screen.availHeight-1)+'px';
    nav.winRight();
  }
  msr.getIE = function(){
    if (typeof this.ie === "undefined") {
      this.ie = new ActiveXObject("InternetExplorer.Application");
    }
    try{
      this.ie.Visible=true;
    }
    catch(err){
      this.ie = new ActiveXObject("InternetExplorer.Application");
      this.ie.Visible=true;
    }
    return this.ie;
  }
  msr.getSH = function(){
    if (typeof this.sh === "undefined") {
      this.sh = new ActiveXObject("WScript.Shell");
    }
    return this.sh;
  }
  msr.quit = function(){
    try{
	  msr.ieObj.Quit();
	  window.close();
	} 
	catch(err){
	  var x=window.confirm(err);
	  if(x){window.close();}
	}
    
  }
  msr.loadMods = function(){
    var p = document.getElementById('content-main');
    var base = document.getElementById('set-mods-baseURL').value;
    var grp = document.getElementById('set-mods');
    var arr=grp.getElementsByTagName('input');
    var name, c, p, el, d1, d2;
    for (i = 0; i < arr.length; i++) {
	  name = name = arr[i].value;
	  c = document.createElement('div');
	  c.id = name;
	  c.innerHTML = '<div style="padding:5px; text-align:center; width:100%;"> Fetching '+name+' Module</div>';
	  p.appendChild(c);
	  el = document.getElementById(name);
	  var wget = new ActiveXObject("InternetExplorer.Application");
	  wget.Navigate(base+name+'.htm');
	  d = Date.now();
	  while (wget.ReadyState != 4){
	    d2 = Date.now();
	    el.innerHTML = '<div style="padding:5px; text-align:center; width:100%;"> Fetching '+name+' Module<br/>'+(d2-d1)+' ms</div>';
	  }
	  try{
	    el.innerHTML = wget.document.getElementsByTagName('body')[0].innerHTML;
      }
	  catch(err){el.innerHTML = '<div style="padding:5px; text-align:center; width:100%;"> Error Fetching '+name+' Module<br/>After'+(d2-d1)+' ms<br/>'+err+'</div>';}
	  wget.Quit();
	  var script = document.createElement('script');
        script.src = base+name+'.js';
        document.head.appendChild(script);
	}
  }
  nav = new Object();
  nav.init = function(){
    $('.main-parts').collapse({toggle: false});
  }
  nav.winLeft = function(){
    window.moveTo(0, 1);
    window.resizeTo(250, screen.availHeight-1);
  }
  nav.winRight = function(){
    window.moveTo(screen.availWidth-250, 1);
    window.resizeTo(250, screen.availHeight-1);
  }
</script>
</head>
<body>
<div id="wrap">

<!-- NavBar -->


<div id="nav-wrap">
  <div style="display:inline; float:left;">
    <h5 id="nav-title">
      CC Remote
    </h5>
  </div>
  <div style="display:inline; float:right;">
    <div class="btn-group">
      <button type="button" id="nav-btn" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
        <span class="glyphicon glyphicon-option-vertical"></span>
      </button>
      <ul class="dropdown-menu pull-right">
        <li>
          <div class="btn-group" style="margin-left:1px;" role="group" id="set-align">
            <button type="button" class="btn btn-default" onclick="nav.winLeft();">
              <span class="glyphicon glyphicon-chevron-left"></span>
            </button>
            <button type="button" class="btn btn-alt">Move</button>
            <button type="button" class="btn btn-default" onclick="nav.winRight();">
              <span class="glyphicon glyphicon-chevron-right"></span>
            </button>
          </div>
        </li>
        <li role="separator" class="divider"></li>
        <li><a href="#" onclick="$('.main-parts').collapse('toggle');">Settings</a></li>
        <li role="separator" class="divider"></li>
        <li><a href="#" onclick="msr.quit();">Exit</a></li>
      </ul>
    </div>
  </div>
  <div style="clear:both;"></div>
</div>
<!-- NavBar End -->

<style>
  #set-cred .input-group{
    margin-bottom: 3px;
  }
  #set-cred .input-group span {
    width: 60px;
  }
  #set-mods .input-group{
    margin-bottom: 3px;
  }
  #set-mods .input-group input{
    margin-top:1px;
    margin-bottom:-1px;
  }
  #set-go{
    text-align: center;
    padding-bottom: 10px;
  }
</style>
<div id="set-panel" class="panel-collapse collapse in main-parts">
  <div class="panel panel-default">
    <div class="panel-body">
      <h4>Credentials</h4>
      <form>
        <fieldset class="form-group" id="set-cred">
          <div class="input-group">
            <span class="input-group-addon">UID</span>
            <input type="text" class="form-control" id="set-uid">
          </div>
          <div class="input-group">
            <span class="input-group-addon">EID</span>
            <input type="text" class="form-control" id="set-eid">
          </div>
          <div class="input-group">
            <span class="input-group-addon">PWD</span>
            <input type="text" class="form-control" id="set-pwd">
          </div>
        </fieldset>
      </form>
      <h4>Modules</h4>
      <form>
        <div class="input-group">
          <span class="input-group-addon">URL</span>
          <input type="text" class="form-control" id="set-mods-baseURL" value="http://lfpnk0.github.io/ccmsr/mods/">
        </div><br/>
        <fieldset class="form-group" id="set-mods">
          <div class="input-group">
            <input type="text" class="form-control" value="ALv1">
            <span class="glyphicon glyphicon-trash input-group-addon"></span>
          </div>
        </fieldset>
      </form>
    </div>
    <div id="set-go">
     <a class="btn btn-success" href="#" onclick="$('.main-parts').collapse('toggle'); msr.loadMods();">
       <b>Lets Go! <span class="glyphicon glyphicon-play-circle"></span></b>
     </a>
    </div>
  </div>
</div>


<div id="content-main" class="panel-collapse collapse main-parts">



<!-- QuickKeys -->
<style>
  .qk-parts table{
    width:230px;
    border-collapse: collapse;
    margin:0px -6px 0px;
  }
  .qk-parts td{
    border:1px solid lightgray;
    padding: 5px;
    text-align:center;
    cursor: pointer;
  }
  .qk-parts table.alt{
    background-color: #f2f2f2;
    border-collapse: collapse;
    color:black;
  }
</style>
<script>
  qk = new Object();
  qk.init = function(){
    $('.qk-parts').collapse({toggle: false});
  }
  qk.shell = new ActiveXObject("WScript.Shell");
  qk.sendKeys = function(key){
    this.shell.appActivate('CaptionNet');
    this.shell.SendKeys(key);
  }
</script>
<div class="panel-group">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <div class="btn-group" role="group">
          <div class="btn-group" role="group">
            <a class="btn btn-default" style="width:170px;" data-toggle="collapse" href="#qk-panel">
              QuickKeys
            </a>
          </div>
          <div class="btn-group" role="group">
            <a class="btn btn-default" data-toggle="collapse" href="#" onclick="$('.qk-parts').collapse('toggle');">
              <span class="glyphicon glyphicon-cog"></span>
            </a>
          </div>
        </div>
      </h4>
    </div>
    <div id="qk-panel" class="panel-collapse collapse">
      <div class="panel-body qk-parts collapse in">
<table><tr>
    <td onclick="qk.sendKeys('{ENTER}{f1}');">Ring</td>
    <td onclick="qk.sendKeys('{ENTER}{f2}{ENTER}');">New</td>
    <td onclick="qk.sendKeys('{ENTER}{f3}{ENTER}');">Auto</td>
    <td onclick="qk.sendKeys('{ENTER}{f4}');">Ans</td>
</tr></table>
<table class="alt"><tr>
    <td onclick="qk.sendKeys('{ENTER}bsyln');">bsyln</td>
    <td onclick="qk.sendKeys('{ENTER}dltn');">dltn</td>
    <td onclick="qk.sendKeys('{ENTER}fxtn');">fxtn</td>
</tr></table>
<table><tr>
    <td onclick="qk.sendKeys(' cryg ');">cryg</td>
    <td onclick="qk.sendKeys(' lgh ');">lgh</td>
    <td onclick="qk.sendKeys(' sgh ');">sgh</td>
    <td onclick="qk.sendKeys(' gspg ');">gspg</td>
</tr></table>
<table><tr>
    <td onclick="qk.sendKeys(' cg ');">cg</td>
    <td onclick="qk.sendKeys(' snz ');">snz</td>
    <td onclick="qk.sendKeys(' ywn ');">ywn</td>
</tr></table>
<table class="alt"><tr>
    <td onclick="qk.sendKeys(' interbkd ');">interbkd</td>
    <td onclick="qk.sendKeys(' inaud  ');">inaud</td>
    <td onclick="qk.sendKeys(' nnout ');">nnout</td>
    <td onclick="qk.sendKeys(' sttc ');">sttc</td>
</tr></table>
<table><tr>
    <td onclick="qk.sendKeys('{ENTER}sln');">sln (151)</td>
    <td onclick="qk.sendKeys('{ENTER}clhd');">clhd</td>
    <td onclick="qk.sendKeys('{ENTER}mscply');">mscply</td>
</tr></table>
<table class="alt"><tr>
    <td onclick="qk.sendKeys('{ENTER}olangcall');">lang5</td>
    <td onclick="qk.sendKeys('{ENTER}stdby');">stdby5</td>
    <td onclick="qk.sendKeys('{ENTER}olang');">lang</td>
</tr></table>
<table><tr>
    <td onclick="qk.sendKeys('{ENTER}spanotn');">spanotn</td>
    <td onclick="qk.sendKeys('{ENTER}scapinit');">scapinit(30)</td>
    <td onclick="qk.sendKeys('{ENTER}scaptrans');">scaptrans</td>
</tr></table>
<table><tr>
    <td onclick="qk.sendKeys('{ENTER}scapnot');">scapnot(60)</td>
    <td onclick="qk.sendKeys('{ENTER}scaptrans');">scaptrans</td>
    <td onclick="qk.sendKeys('{ENTER}scapcanc');">scapcanc</td>
</tr></table>
<table><tr>
    <td><input id="qk-custom" type="text" value=" Uh-uh" /></td>
    <td onclick="qk.sendKeys(document.getElementById('qk-custom').value);"><span class="glyphicon glyphicon-chevron-right"></span></td>
</tr></table>
      </div>
      <div class="panel-body qk-parts collapse">
Settings
      </div>
    </div>
  </div>
</div>
<script>qk.init();</script>
<!-- QuickKeys End -->

<!-- Timeclock -->
<script>
  tc = new Object();
  tc.init = function(){
    $('.tc-parts').collapse({toggle: false});
    tc.int = setInterval(function(){tc.run();},1000);
  }
  tc.run = function(){
    datetime = new Date();
    document.getElementById('tc-datetime').innerHTML = datetime;
  }
</script>
<div class="panel-group">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <div class="btn-group" role="group">
          <div class="btn-group" role="group">
            <a class="btn btn-default" style="width:170px;" data-toggle="collapse" href="#tc-panel">
              Time Clock
            </a>
          </div>
          <div class="btn-group" role="group">
            <a class="btn btn-default" data-toggle="collapse" href="#" onclick="$('.tc-parts').collapse('toggle');">
              <span class="glyphicon glyphicon-cog"></span>
            </a>
          </div>
        </div>
      </h4>
    </div>
    <div id="tc-panel" class="panel-collapse collapse">
      <div class="panel-body tc-parts collapse in">
<span id="tc-datetime"></span>
<span id="tc-countdown"></span>
      </div>
      <div class="panel-body tc-parts collapse">
<form>
<input type="text"
</form>
      </div>
    </div>
  </div>
</div>
<script>
  tc.init();
</script>
<!-- Timeclock End -->




</div> <!-- content-main End -->
<style> <!-- footer Start -->
  html {
    position: relative;
    min-height: 100%;
  }
  #footer{
    position: absolute;
    bottom: 0;
    width: 248px;
    /* Set the fixed height of the footer here */
    height: 30px;
    background-color: gray;
	margin-bottom: 1px;
	overflow:hidden;
  }
  #log{
	display:inline-block;
	width:225px;
	height: 30px;
	float:right;
	margin-right:-17px;
	padding: 5px;
	overflow-y:scroll;
	color: lightgray;
  }
  #log-btn{
    background-color:gray;
    color:lightgray;
    border:0px;
	height:29px;
  }
</style>
<script>
  msr.logView = function(){
    lw=window.showModelessDialog();
	str = document.getElementById('log').innerHTML;
	var c = lw.document.createElement('div');
	c.id='log';
	c.style.cssText = 'padding:10px;';
	c.innerHTML = str;
	lw.document.getElementsByTagName('body')[0].appendChild(c);
  }
  msr.log = function(data){
    var log = document.getElementById('log');
	switch (data.constructor){
	  case Array:
	    log.innerHTML = log.innerHTML+'<br/>'+JSON.stringify(data);
		break;
      case Object:
	    log.innerHTML = log.innerHTML+'<br/>'+JSON.stringify(data);
		break;
      default:
	    log.innerHTML = log.innerHTML+'<br/>'+data;
	}
  }
</script>
<div id='footer'>
<button id="log-btn" type="button" class="btn" onclick="msr.logView();">
  <span class="glyphicon glyphicon-modal-window"></span>
</button>
<div id="log"></div>
</div> <!-- footer End -->
<script>
  nav.init();
  msr.init();
</script>
</div> <!-- wrap End -->
</body>
</html>
