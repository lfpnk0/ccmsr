<html>
<head>
 <link href='assets/base.css' rel='stylesheet' type='text/css'>
<style>
table{
 width:225px;
 border-collapse: collapse;
}
td{
 border: 1px solid black;
 border-top: 0px;
 text-align:center;
 padding-top: 0.5em;
 padding-bottom: 0.5em;
 cursor: pointer;
}
.alt{
 background-color:lightgray;
}
</style>
</head>
<body>
 <table class="titleBar">
  <tr>
   <td onclick="settings();"><img class="icon" src="ico/settings.png"></td>
   <td class="title" onclick="collapse();">QuickKeys</td>
   <td onclick="captionNet();"><img class="icon" src="ico/headset.png"></td>
  </tr>
 </table>
 <div id="content" style="display:block;">
  <table>
   <tr>
    <td onclick="send('{ENTER}{f1}');">Ring</td>
    <td onclick="send('{ENTER}{f2}{ENTER}');">New</td>
    <td onclick="send('{ENTER}{f3}{ENTER}');">Auto</td>
    <td onclick="send('{ENTER}{f4}');">Ans</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send('{ENTER}bsyln');">bsyln</td>
    <td onclick="send('{ENTER}dltn');">dltn</td>
    <td onclick="send('{ENTER}fxtn');">fxtn</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send(' cryg ');">cryg</td>
    <td onclick="send(' lgh ');">lgh</td>
    <td onclick="send('sgh ');">sgh</td>
    <td onclick="send('gspg ');">gspg</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send(' cg ');">cg</td>
    <td onclick="send(' snz ');">snz</td>
    <td onclick="send(' ywn ');">ywn</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send(' interbkd ');">interbkd</td>
    <td onclick="send(' inaud ');">inaud</td>
    <td onclick="send(' nnout ');">nnout</td>
    <td onclick="send(' sttc ');">sttc</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td id="sln" onclick="send('{ENTER}sln ',this.id);">sln</td>
    <td onclick="send('{ENTER}clhd');">clhd</td>
    <td onclick="send('{ENTER}mscply');">mscply</td>
   </tr>
  </table>
  <table>
   <tr>
    <td id="lang1" onclick="send('{ENTER}olangcall ',this.id);">olangcall</td>
    <td id="stndby" onclick="olang(this,'click');">stndby</td>
    <td id="olang" onclick="olang(this,'click');">olang</td>
    <td id="scapinit" onclick="scap(this,'click');">scapinit</td>
    <td id="scaptrans" onclick="scap(this,'click');">scaptrans</td>
    <td id="scapnot" onclick="scap(this,'click');">scapnot</td>
    <td id="scaptrans" onclick="scap(this,'click');">scaptrans</td>
    <td id="scapcanc" onclick="scap(this,'click');">scapcanc</td>
    <td width=40px onclick="clear(this.parentNode);"><img class="icon" src="ico/del.png"></td>
   </tr>
  </table>
  <table>
   <tr>
    <td><input type="text" id="text" value="Uh-uh." /></td>
    <td width=40px onclick="send(document.getElementById('text').value);"><img class="icon" src="ico/go.png"></td>
   </tr>
  </table>
 </div>
 <div id="settings" style="display:none;">
  Settings
 </div>
 <script src="assets/base.js"></script>
 <script>
  window.parent.document.getElementById('qk').height = '420px'; //402 px
  qk = new Object();
  qk.shell = new ActiveXObject("WScript.Shell");
  qk.t = new Object();
  qk.t.sln = new Object();
  qk.t.sln.s = -1;
  qk.t.lang = new Object();
  qk.t.lang.s = -1;
  qk.t.scap = new Object();
  qk.t.scap.s = -1;
  
  qk.p = new Object();
  qk.p.sln = new Object();
  qk.p.sln.s = 300;
  qk.p.sln.f = function(){
   qk.p.sln.s--;
   document.getElementById('sln').innerHTML = 'sln ('+qk.p.sln.s+')';
   if(qk.p.sln.s==240){document.getElementById('sln').style.backgroundColor = 'orange';}
   if(qk.p.sln.s==0){document.getElementById('sln').style.backgroundColor = 'red';clearInterval(qk.p.sln.i);qk.p.sln.s=300;}
  }
  qk.p.lang1 = new Object();
  
  
  function captionNet(){
   qk.shell.exec('C:/Program Files/CaptionCall/CaptionNet/2.2.53/CaptionNet.exe');
  }

  function send(key, id){
   qk.shell.AppActivate('Untitled - Notepad'); //CaptionNet
   qk.shell.SendKeys(key);
   if(typeof id !== 'undefined'){
    qk.p[id].i = setInterval(qk.p[id].f,1000);
   }
  }
  function fsln(){
  }
  function sln(el, method){
   if(method=='click'){
    if(qk.t.sln.s < 0){
     send('{ENTER}sln');
     el.innerHTML = '5:00';
     qk.t.sln.s = 300;
     qk.t.sln.i = setInterval(function(){
      qk.t.sln.s--;
      var s = ('0'+qk.t.sln.s).slice(-2)
      el.innerHTML = 'sln '+s;
      sln(el,'check');
     }, 1000);
    }
    else{
     if(qk.t.sln.i > 0){clearInterval(qk.t.sln.i);}
     qk.t.sln.s = -1;
     el.innerHTML = 'sln';
     el.style.backgroundColor = 'transparent';
    }
   }
   else{
    switch(qk.t.sln.s){
     case 240:
      el.style.backgroundColor = 'orange';
      break;
     case 0:
      el.style.backgroundColor = 'red';
      qk.shell.SendKeys("%c");
      clearInterval(qk.t.sln.i);
      qk.t.sln.i = -1;
      break;
    }
   }
  }
  function olang(el, method){
   if(method=='click' || qk.t.lang.s==0){
    switch(el.innerHTML.slice(6)){
     case 'olangc':
      send('{ENTER}olangcall');
      el.innerHTML = 'stndby 300';
      qk.t.lang.s = 300;
      qk.t.lang.txt = 'stndby';
      qk.t.lang.i = setInterval(function(){
       qk.t.lang.s--;
       var s = ('0'+qk.t.lang.s).slice(-2);
       el.innerHTML = qk.t.lang.txt+' '+s;
       olang(el, 'check');
      }, 1000);
      break;
     case 'stndby':
      send('{ENTER}stndby');
      el.innerHTML = 'olang 300';
      qk.t.lang.s = 300;
      qk.t.lang.txt = 'olang';
      break;
     case 'olang ':
      send('{ENTER}olang');
      clearInterval(qk.t.lang.i);
      qk.t.lang.i = -1;
      el.style.backgroundColor = 'red';
      break;
    }
   }
  }
  function scap(el,method){
   if(method == 'click' || qk.t.scap.s==0){
    switch(el.innerHTML.slice(5)){
     case 'scapi':
      send('{ENTER}scapinit1{ENTER}scapinit2');
      el.innerHTML = 'scaptrans 30';
      qk.t.scap.s = 30;
      qk.t.scap.txt = 'scaptrans';
      qk.t.scap.i = setInterval(function(){
       qk.t.scap.s--;
       var s = ('0'+s).slice(-2);
       el.innerHTML = qk.t.scap.txt+' '+s;
       scap(el);
      }, 1000);
      break;
     case 'scapt':
      send('{ENTER}scaptrans');
      el.innerHTML = 'scapnot';
      clearInterval(qk.t.scap.i);
      qk.t.scap.i = -1;
      break;
     case 'scapn':
      send('{ENTER}scapnot');
      el.innerHTML = '2-scaptrans 60';
      qk.t.scap.s = 60;
      qk.t.scap.txt = '2-scaptrans';
      qk.t.scap.i = setInterval(function(){
       qk.t.scap.s--;
       var s = ('0'+s).slice(-2);
       el.innerHTML = qk.t.scap.txt+' '+s;
       scap(el);
      }, 1000);
      break;
     case '2-sca':
      send('{ENTER}scaptrans');
      el.innerHTML = 'scapcanc';
      clearInterval(qk.t.scap.i);
      qk.t.scap.i = -1;
     case 'scapc':
      send('{ENTER}scapcanc');
    }
   }
  }
  function clear(p){
   if(qk.t.lang.i > 0){
    clearInterval(qk.t.lang.i);
    qk.t.lang.i = -1
   }
   p.children[0].backgroundColor = 'transparent';
   p.children[0].innerHTML = 'lang';
   if(qk.t.scap.i > 0){
    clearInterval(qk.t.scap.i);
    qk.t.scap.i = -1;
   }
   p.children[1].backgroundColor = 'transparent';
   p.children[1].innerHTML = 'scapinit';
  }
 </script>
</body>
</html>
