<html>
<head>
 <link href='assets/base.css' rel='stylesheet' type='text/css'>
<style>
table{
 width:225px;
 border-collapse: collapse;
}
td{
 border: 1px solid black;
 border-top: 0px;
 text-align:center;
 padding-top: 0.5em;
 padding-bottom: 0.5em;
 cursor: pointer;
}
.alt{
 background-color:lightgray;
}
</style>
</head>
<body>
 <table class="titleBar">
  <tr>
   <td onclick="settings()"><img class="icon" src="ico/settings.png"></td>
   <td class="title" onclick="collapse()">QuickKeys</td>
   <td onclick="captionNet()"><img class="icon" src="ico/headset.png"></td>
  </tr>
 </table>
 <div id="content" style="display:block;">
  <table>
   <tr>
    <td onclick="send('{ENTER}{f1}')">Ring</td>
    <td onclick="send('{ENTER}{f2}{ENTER}')">New</td>
    <td onclick="send('{ENTER}{f3}{ENTER}')">Auto</td>
    <td onclick="send('{ENTER}{f4}')">Ans</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send('{ENTER}bsyln')">bsyln</td>
    <td onclick="send('{ENTER}dltn')">dltn</td>
    <td onclick="send('{ENTER}fxtn')">fxtn</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send(' cryg ')">cryg</td>
    <td onclick="send(' lgh ')">lgh</td>
    <td onclick="send('sgh ')">sgh</td>
    <td onclick="send('gspg ')">gspg</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send(' cg ')">cg</td>
    <td onclick="send(' snz ')">snz</td>
    <td onclick="send(' ywn ')">ywn</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send(' interbkd ')">interbkd</td>
    <td onclick="send(' inaud ')">inaud</td>
    <td onclick="send(' nnout ')">nnout</td>
    <td onclick="send(' sttc ')">sttc</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="sln(this,'set');">sln (151)</td>
    <td onclick="send('{ENTER}clhd')">clhd</td>
    <td onclick="send('{ENTER}mscply')">mscply</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send('{ENTER}olangcall')">Lang5</td>
    <td onclick="send('{ENTER}stndby')">Stdby5</td>
    <td onclick="send('{ENTER}olang')">Lang</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send('{ENTER}spanotn')">spanotn</td>
    <td onclick="send('{ENTER}scapinit1{ENTER}scapinit2')">scapinit (30)</td>
    <td onclick="send('{ENTER}scaptrans')">scaptrans</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send('{ENTER}scapnot')">scapnot (60)</td>
    <td onclick="send('{ENTER}scaptrans')">scaptrans</td>
    <td onclick="send('{ENTER}scapcanc')">scapcanc</td>
   </tr>
  </table>
  <table>
   <tr>
    <td><input type="text" id="text" value="Uh-uh." /></td>
    <td width=40px onclick="send(document.getElementById('text').value)"><img class="icon" src="ico/go.png"></td>
   </tr>
  </table>
 </div>
 <div id="settings" style="display:none;">
  Settings
 </div>
 <script src="assets/base.js"></script>
 <script>
  window.parent.document.getElementById('qk').height = '420px'; //402 px
  qk = new Object();
  qk.shell = new ActiveXObject("WScript.Shell");
  qk.t = new Object();
  qk.t.sln = new Object();
  qk.t.sln.s = -1;
  qk.t.lang = new Object();
  qk.t.lang.s = -1;
  qk.t.span = new Object();
  qk.t.span.s = -1;
  function send(key){
   qk.shell.AppActivate('CaptionNet');
   qk.shell.SendKeys(key);
  }
  function captionNet(){
   qk.shell.exec('C:/Program Files/CaptionCall/CaptionNet/2.2.53/CaptionNet.exe');
  }
  function sln(el, action){
   if(action=='set'){
    if(qk.t.sln.s < 0){
     send('{ENTER}sln');
     el.innerHTML = '0:00';
     qk.t.sln.s = 0;
     qk.t.sln.i = setInterval(function(){
      qk.t.sln.s++;
      el.innerHTML = Math.floor(qk.t.sln.s/60)+':'+(qk.t.sln.s-(60*Math.floor(qk.t.sln.s/60)));
      sln(el,'check');
     }, 1000);
    }
    else{
     clearInterval(qk.t.sln.i)
     el.innerHTML = 'sln';
     qk.t.sln.s = -1;
     el.style.backgroundColor = transparent;
    }
   }
   else{
    switch(qk.t.sln.s){
     case 60:
      el.style.backgroundColor = 'orange';
      break;
     case 300:
      el.style.backgroundColor = 'red';
      break;
    }
   }
  }
 </script>
</body>
</html>
