<html>
<head>
 <link href='assets/base.css' rel='stylesheet' type='text/css'>
 <embed src="assets/tone.mp3" autostart="false" width="0" height="0" id="alert" enablejavascript="true">
<style>
table{
 width:225px;
 border-collapse: collapse;
}
td{
 border: 1px solid black;
 border-top: 0px;
 text-align:center;
 padding-top: 5px;
 padding-bottom: 5px;
 cursor: pointer;
}
.alt{
 background-color:lightgray;
}
</style>
</head>
<body>
 <table class="titleBar">
  <tr>
   <td onclick="settings(qk);"><img class="icon" src="ico/settings.png"></td>
   <td class="title" onclick="collapse(qk);">QuickKeys</td>
   <td onclick="captionNet();"><img class="icon" src="ico/headset.png"></td>
  </tr>
 </table>
 <div id="content" style="display:block;">
  <table>
   <tr>
    <td onclick="send('{ENTER}{f1}');">Ring</td>
    <td onclick="send('{ENTER}{f2}{ENTER}');">New</td>
    <td onclick="send('{ENTER}{f3}{ENTER}');">Auto</td>
    <td onclick="send('{ENTER}{f4}');">Ans</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send('{ENTER}bsyln');">bsyln</td>
    <td onclick="send('{ENTER}dltn');">dltn</td>
    <td onclick="send('{ENTER}fxtn');">fxtn</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send(' cryg ');">cryg</td>
    <td onclick="send(' lgh ');">lgh</td>
    <td onclick="send('sgh ');">sgh</td>
    <td onclick="send('gspg ');">gspg</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td onclick="send(' cg ');">cg</td>
    <td onclick="send(' snz ');">snz</td>
    <td onclick="send(' ywn ');">ywn</td>
   </tr>
  </table>
  <table>
   <tr>
    <td onclick="send(' interbkd ');">interbkd</td>
    <td onclick="send(' inaud ');">inaud</td>
    <td onclick="send(' nnout ');">nnout</td>
    <td onclick="send(' sttc ');">sttc</td>
   </tr>
  </table>
  <table class="alt">
   <tr>
    <td id="sln" onclick="send(this.id);">sln</td>
    <td onclick="send('{ENTER}clhd');">clhd</td>
    <td onclick="send('{ENTER}mscply');">mscply</td>
   </tr>
  </table>
  <table>
   <tr>
    <td id="lang1" onclick="send(this.id);">olangcall</td>
    <td id="lang2" style="display:none" onclick="send(this.id);">stndby</td>
    <td id="lang3" style="display:none" onclick="send(this.id);">olang</td>
    <td id="scap1" onclick="send(this.id);">scapinit</td>
    <td id="scap2" style="display:none" onclick="send(this.id);">scaptrans</td>
    <td id="scap3" style="display:none" onclick="send(this.id);">scapnot</td>
    <td id="scap4" style="display:none" onclick="send(this.id);">scaptrans</td>
    <td id="scap5" style="display:none" onclick="send(this.id);">scapcanc</td>
    <td width=40px onclick="clear(this.parentNode);"><img class="icon" src="ico/del.png"></td>
   </tr>
  </table>
  <table>
   <tr>
    <td><input type="text" id="text" value="Uh-uh. " /></td>
    <td width=40px onclick="send(document.getElementById('text').value);"><img class="icon" src="ico/go.png"></td>
   </tr>
  </table>
 </div>
 <div id="settings">
 <table class="titleBar">
  <tr>
   <td onclick="saveSettings();"><img class="icon" src="ico/save.png"></td>
   <td class="title" onclick="alert(JSON.stringify(qk));">Settings</td>
   <td>&nbsp;</td>
  </tr>
 </table>
 <div class="scrollable">
  <form id="settingsForm">
  </form>
 </div>
 <script src="assets/base.js"></script>
 <script src="assets/json2.js"></script>
 <script>
  mod = new Object();
  mod.id = 'qk01';
  mod.height = '278';
  height(mod.height);
  getSettings(mod.id);
  mod.shell = new ActiveXObject("WScript.Shell");
  
  mod.p = new Object();
  mod.p.sln = new Object();
  mod.p.sln.s = 300;
  mod.p.sln.f = function(){
   if(mod.p.sln.s==300){send('{ENTER}sln ');}
   mod.p.sln.s--;
   document.getElementById('sln').innerHTML = 'sln ('+mod.p.sln.s+')';
   if(mod.p.sln.s==240){
    document.getElementById('sln').style.backgroundColor = 'orange';
    bell();
   }
   if(mod.p.sln.s==0){
    document.getElementById('sln').style.backgroundColor = 'red';
    clearInterval(mod.p.sln.i);
    mod.p.sln.i = -1;
    bell();
   }
  }
  mod.p.lang1 = new Object(); //olangcall button
  mod.p.lang1.s = 300;
  mod.p.lang1.f = function(){
   //first run
   if(mod.p.lang1.s==300){
    send('{ENTER}olangcall ');
    document.getElementById('lang1').style.display = 'none';
    document.getElementById('lang2').style.display = 'table-cell';
   }
   //iterations
   mod.p.lang1.s--;
   document.getElementById('lang2').innerHTML = 'stndby ('+mod.p.lang1.s+')';
   //last run
   if(mod.p.lang1.s==0){
    mod.p.lang2.i = setInterval(mod.p.lang2.f,1000);
   }
  }
  mod.p.lang2 = new Object(); //stndby button
  mod.p.lang2.s = 300; 
  mod.p.lang2.f = function(){
   //first run
   if(mod.p.lang2.s==300){ 
    clearInterval(mod.p.lang1.i);
    mod.p.lang1.i = -1;
    document.getElementById('lang2').innerHTML = 'stndby';
    send('{ENTER}stndby ');
    document.getElementById('lang2').style.display = 'none';
    document.getElementById('lang3').style.display = 'table-cell';
   }
   //iterations
   mod.p.lang2.s--;
   document.getElementById('lang3').innerHTML = 'olang ('+mod.p.lang2.s+')';
   //last run
   if(mod.p.lang2.s==0){
    clearInterval(mod.p.lang2.i);
    mod.p.lang2.i = -1;
    document.getElementById('lang3').innerHTML = 'olang';
    document.getElementById('lang3').style.backgroundColor = 'red';
    bell();
   }
  }
  mod.p.lang3 = new Object(); //olang button
  mod.p.lang3.f = function(){
   clear();
   send('{ENTER}olang ');
  }
  
  mod.p.scap1 = new Object(); //scapinit button
  mod.p.scap1.s = 30;
  mod.p.scap1.f = function(){
   //first run
   if(mod.p.scap1.s==30){
    send('{ENTER}scapinit1 {ENTER}scapinit2 ');
    document.getElementById('scap1').style.display = 'none';
    document.getElementById('scap2').style.display = 'table-cell';
   }
   //iterations
   mod.p.scap1.s--;
   document.getElementById('scap2').innerHTML = 'scaptrans ('+mod.p.scap1.s+')';
   //last run
   if(mod.p.scap1.s==0){
    document.getElementById('scap2').style.backgroundColor = 'red';
    bell();
    clearInterval(mod.p.scap1.i);
    mod.p.scap1.i = -1;
   }
  }
  mod.p.scap2 = new Object(); //scaptrans button
  mod.p.scap2.f = function(){
   clearInterval(mod.p.scap1.i);
   send('{ENTER}scaptrans ');
   document.getElementById('scap2').style.display = 'none';
   document.getElementById('scap3').style.display = 'table-cell';
   clearInterval(mod.p.scap2.i);
   mod.p.scap2.i = -1;
  }
  mod.p.scap3 = new Object(); //scapnot button
  mod.p.scap3.s = 60;
  mod.p.scap3.f = function(){
   //first run
   if(mod.p.scap3.s==60){
    send('{ENTER}scapnot ');
    document.getElementById('scap3').style.display = 'none';
    document.getElementById('scap4').style.display = 'table-cell';
   }
   //iterations
   mod.p.scap3.s--;
   document.getElementById('scap4').innerHTML = 'scaptrans ('+mod.p.scap3.s+')';
   //last run
   if(mod.p.scap3.s==0){
    document.getElementById('scap4').style.backgroundColor = 'red';
    clearInterval(mod.p.scap3.i);
    mod.p.scap3.i = -1;
   }
  }
  mod.p.scap4 = new Object(); //scaptrans (2) button
  mod.p.scap4.f = function(){
   clearInterval(mod.p.scap3.i);
   send('{ENTER}scaptrans ');
   document.getElementById('scap4').style.backgroundColor = 'transparent';
   document.getElementById('scap4').style.display = 'none';
   document.getElementById('scap5').style.display = 'table-cell';
   clearInterval(mod.p.scap4.i);
   mod.p.scap4.i = -1;
  }
  mod.p.scap5 = new Object(); //scapcanc button
  mod.p.scap5.f = function(){
   send('{ENTER}scapcanc ');
   clear();
  }
  
  function captionNet(){
   mod.shell.exec('C:/Program Files/CaptionCall/CaptionNet/2.2.53/CaptionNet.exe');
  }
  function send(key){
   if(typeof mod.p[key] !== 'undefined'){
    if(mod.p[key].i > 0){clear();}
    mod.p[key].i = setInterval(mod.p[key].f,1000);
   }
   else{
    mod.shell.AppActivate('Untitled - Notepad'); //CaptionNet
    mod.shell.SendKeys(key);
   }
  }
  function clear(){
   clearInterval(mod.p.sln.i);
    mod.p.sln.i = -1;
    mod.p.sln.s=300;
    document.getElementById('sln').innerHTML = 'sln';
    document.getElementById('sln').style.backgroundColor = 'transparent';
   clearInterval(mod.p.lang1.i);
    mod.p.lang1.i = -1;
    mod.p.lang1.s=300;
    document.getElementById('lang1').style.display = 'table-cell';
   clearInterval(mod.p.lang2.i);
    mod.p.lang2.i = -1;
    mod.p.lang2.s=300;
    document.getElementById('lang2').innerHTML = 'stndby';
    document.getElementById('lang2').style.display = 'none';
   clearInterval(mod.p.lang3.i);
    mod.p.lang3.i = -1;
    document.getElementById('lang3').innerHTML = 'olang';
    document.getElementById('lang3').style.backgroundColor = 'transparent';
    document.getElementById('lang3').style.display = 'none';
   clearInterval(mod.p.scap1.i);
    mod.p.scap1.i = -1;
    mod.p.scap1.s = 30;
    document.getElementById('scap1').style.display = 'table-cell';
   clearInterval(mod.p.scap2.i);
    mod.p.scap2.i = -1;
    document.getElementById('scap2').innerHTML = 'scaptrans';
    document.getElementById('scap2').style.backgroundColor = 'transparent';
    document.getElementById('scap2').style.display = 'none';
   clearInterval(mod.p.scap3.i);
    mod.p.scap3.i = -1;
    mod.p.scap3.s = 60;
    document.getElementById('scap3').style.display = 'none';
   clearInterval(mod.p.scap4.i);
    mod.p.scap4.i = -1;
    document.getElementById('scap4').innerHTML = 'scaptrans';
    document.getElementById('scap4').style.backgroundColor = 'transparent';
    document.getElementById('scap4').style.display = 'none';
   clearInterval(mod.p.scap5.i);
    mod.p.scap5.i = -1;
    document.getElementById('scap5').style.display = 'none';
  }
  function bell(){
   var sound = document.getElementById('alert');
   sound.Play();
  }
 </script>
</body>
</html>
