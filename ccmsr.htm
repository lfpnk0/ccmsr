<!DOCTYPE html>
<html>
	<head>
		<script>
			m = new Object();
		</script>
	</head>
	<body>
		<module id="mod_base">
			<page class="settings">
				<form>
					<label>Window Height</label>
					<input type="text" id="base_height" value=150 />
					<label>Window Width</label>
					<input type="text" id="base_width" value=150 />
					<label>Window Location</label>
					<input type="text" id="base_location" value="right" />
				</form>
			</page>
			<page class="main">
			</page>
			<script>
				function base_init(){
					var topWin = window;
					//parent.document.body.style.backgroundColor = "red";
					topWin.document.body.style.background = 'orange';
					while (!topWin == topWin.parent){
						topWin=topWin.parent;
						
					}
					topWin.document.body.style.background = 'red';
					//var w = document.getElementById('base_width');
					//var h = document.getElementById('base_height');
					//if(document.getElementById('base_location').value=='right'){
						//topWin.moveTo(screen.availWidth-w,0);
						//topWin.resizeTo(w,h);
					//}
					//else{
						//topWin.moveTo(w,0);
						//topWin.resizeTo(w,h);
					//}
				}
				base_init();
			</script>
		</module>
		<module id="mod_qk">
			<page class="settings">
				<form>
					<input type="text" id="qk_app" value="CaptionNet" />
				</form>
			</page>
			<page class="main">
				<button onclick="activate();">activate</button>
			</page>
			<script>
				function activate(){
					m.shell = new ActiveXObject("WScript.Shell");
					m.shell.AppActivate(document.getElementById('qk_app').value);
				}
			</script>
		</module>
	</body>
</html>
